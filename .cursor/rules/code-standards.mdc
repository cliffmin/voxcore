---
description: VoxCore coding standards and conventions
globs: ["**/*.lua", "**/*.java", "**/*.sh", "**/*.py"]
alwaysApply: true
---

# VoxCore Code Standards

## Language-Specific Standards

### Lua (Hammerspoon)
- Small, idiomatic functions
- Keep functions short and pure where possible
- Follow existing patterns in `hammerspoon/`

### Java (whisper-post-processor)
- Standard Gradle layout
- Pure functions for processors (stateless)
- Follow existing processor patterns
- See `whisper-post-processor/README.md` for structure

### Shell Scripts
- POSIX sh where practical
- zsh scripts are fine if clearly marked
- See `scripts/` for examples

## General Standards

### Formatting
- 2-space indent (see `.editorconfig`)
- LF line endings
- No trailing whitespace

### Code Organization
- **Core logic**: `whisper-post-processor/` (Java) or `hammerspoon/` (Lua)
- **Setup/utilities**: `scripts/`
- **Tests**: With code (Java) or `tests/` (integration)
- **Docs**: `docs/` (public) or `internal/docs/` (internal)

### Anti-Patterns to Avoid
- Creating new directories without justification
- Dumping scripts in root or random locations
- Personal, one-off workflows embedded in repo
- Breaking changes without migration notes
- Large binaries in repo
- Heavy external deps for simple tasks
- Mixing concerns (e.g., audio processing logic in Lua UI layer)

### Before Making Changes
1. Check existing patterns in similar files
2. Run tests: `make test` or `make test-java-all`
3. Update docs if user-facing change
4. Update CHANGELOG.md under [Unreleased] for user-visible changes
